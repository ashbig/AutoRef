/*
 * CustomerManager.java
 *
 * Created on March 26, 2003, 2:36 PM
 */

package src.core;
import src.database.*;
import java.sql.*;

/**
 *
 * @author  hweng
 */
public class CustomerManager {
    
    /** Creates a new instance of CustomerManager */
    public CustomerManager() {
    }
    
    public boolean registrate(String firstname, String lastname, String department, String institute, 
                               String street1, String street2, String city, String state, String zipcode,
                               String country, String email, String authorizedname, String title)
    {        
        DBManager manager = new DBManager();
        Connection conn = manager.connect();
        
        if (conn == null) {
            System.out.println("Cannot connect to the database.");
            return false;
        }
        
        String sql = "insert into customers "+
        " (lastname, firstname, department, institute, street1, street2, "+
        " city, state, zipcode, country, email, authorizedname, title)"+
        " values('" + lastname + "','" + firstname + "','" + department +
        "','" + institute + "','" + street1 + "','" + street2 +
        "','" + city + "','" + state + "','" + zipcode + "','" + country + 
        "','" + email + "','" + authorizedname + "','" + title + "')";

        Statement stmt = null;
        boolean rt = false;
        
        try {
            stmt = conn.createStatement();
            int n = stmt.executeUpdate(sql);
            manager.commit(conn);
            rt = true;
            stmt.close();
        } catch (SQLException ex) {
            System.out.println(ex);
        } finally {
            manager.disconnect(conn);
        }

        return rt;
    }
        

        
    public boolean DoesExist(String email) {
       
        DBManager manager = new DBManager();
        Connection conn = manager.connect();
        
        if (conn == null) {
            System.out.println("Cannot connect to the database.");
            return false;
        }
        
        String sql = "select * from customers where email = '" + email + "'";
        Statement stmt = null;
        boolean rt = false;
        
        try {
            stmt = conn.createStatement();
            ResultSet rs = stmt.executeQuery(sql);            
            if(rs.next()) {
                rt = true;
            }            
            stmt.close();
        } catch (SQLException ex) {
            System.out.println(ex);
        } finally {
            manager.disconnect(conn);
        }

        return rt;
    }          
    
    /*
    public getReservation(String customer_email){
                        
        DBManager manager = new DBManager();
        Connection conn = manager.connect();
        
        if (conn == null) {
            System.out.println("Cannot connect to the database.");
            return false;
        }
        
        String sql = "select * from customers where email = '" + email + "'";
        Statement stmt = null;
        boolean rt = false;
    */
    
    public static void main(String[] args){
        CustomerManager m = new CustomerManager();
        m.registrate("haifeng", "weng", "hip", "proteomics", "250 longwood ave", "78", "boston", "MA", "02115", 
                    "USA", "hweng@ccs.neu.edu", "J", "informaticist");
        System.out.println("done");
    }
}
